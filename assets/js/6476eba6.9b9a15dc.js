"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5722],{4922:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>f,frontMatter:()=>s,metadata:()=>c,toc:()=>l});var r=t(4848),a=t(8453);const s={},i="Usage",c={id:"usage",title:"Usage",description:"Browser",source:"@site/docs/usage.md",sourceDirName:".",slug:"/usage",permalink:"/x509/docs/usage",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Installation",permalink:"/x509/docs/installation"},next:{title:"Exports",permalink:"/x509/docs/api/"}},o={},l=[{value:"Browser",id:"browser",level:3},{value:"Set crypto provider for Node.js",id:"set-crypto-provider-for-nodejs",level:3},{value:"Create a self-signed certificate",id:"create-a-self-signed-certificate",level:3},{value:"Parse a x509 certificate",id:"parse-a-x509-certificate",level:3},{value:"Create a PKCS#10 certificate request",id:"create-a-pkcs10-certificate-request",level:3},{value:"Decoded X509 certificate",id:"decoded-x509-certificate",level:3},{value:"Build a certificate chain",id:"build-a-certificate-chain",level:3},{value:"Export a list of X509 certificates to PKCS#7 format",id:"export-a-list-of-x509-certificates-to-pkcs7-format",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"usage",children:"Usage"})}),"\n",(0,r.jsx)(n.h3,{id:"browser",children:"Browser"}),"\n",(0,r.jsxs)(n.p,{children:["Every release of ",(0,r.jsx)(n.code,{children:"@peculiar/x509"})," will have new build of ",(0,r.jsx)(n.code,{children:"./build/x509.js"})," for use in the browser. To get access to module classes use ",(0,r.jsx)(n.code,{children:"x509"})," global variable."]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"WARN: We recommend hosting and controlling your own copy for security reasons"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<script src="https://unpkg.com/@peculiar/x509"><\/script>\n'})}),"\n",(0,r.jsx)(n.p,{children:"A simple web application examples"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://codesandbox.io/s/generate-cert-fjwfh",children:"Generate X509 certificate"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://codesandbox.io/s/generate-csr-0qhed",children:"Generate PKCS#10 certificate request"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"set-crypto-provider-for-nodejs",children:"Set crypto provider for Node.js"}),"\n",(0,r.jsx)(n.p,{children:"In some cases you may want to use a different cryptographic implementation, for example when you want to work with an object that supports a cryptographic algorithm not supported by the platform you are on."}),"\n",(0,r.jsxs)(n.p,{children:["In these cases you can set a custom provider, these providers need to be compatible with the WebCrypto API, for example on NodeJS you can use ",(0,r.jsx)(n.code,{children:"@peculiar/webcrypto"})," to allow ",(0,r.jsx)(n.code,{children:"@peculiar/x509"})," to work the same as it does in browser!"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'import * as x509 from "@peculiar/x509";\nimport { Crypto } from "@peculiar/webcrypto";\n\nconst crypto = new Crypto();\nx509.cryptoProvider.set(crypto);\n'})}),"\n",(0,r.jsx)(n.h3,{id:"create-a-self-signed-certificate",children:"Create a self-signed certificate"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'const alg = {\n  name: "RSASSA-PKCS1-v1_5",\n  hash: "SHA-256",\n  publicExponent: new Uint8Array([1, 0, 1]),\n  modulusLength: 2048,\n};\nconst keys = await crypto.subtle.generateKey(alg, false, ["sign", "verify"]);\nconst cert = await x509.X509CertificateGenerator.createSelfSigned({\n  serialNumber: "01",\n  name: "CN=Test",\n  notBefore: new Date("2020/01/01"),\n  notAfter: new Date("2020/01/02"),\n  signingAlgorithm: alg,\n  keys,\n  extensions: [\n    new x509.BasicConstraintsExtension(true, 2, true),\n    new x509.ExtendedKeyUsageExtension(["1.2.3.4.5.6.7", "2.3.4.5.6.7.8"], true),\n    new x509.KeyUsagesExtension(x509.KeyUsageFlags.keyCertSign | x509.KeyUsageFlags.cRLSign, true),\n    await x509.SubjectKeyIdentifierExtension.create(keys.publicKey),\n  ]\n});\n\nconsole.log(cert.toString("pem")); // Certificate in PEM format\n'})}),"\n",(0,r.jsx)(n.h3,{id:"parse-a-x509-certificate",children:"Parse a x509 certificate"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'const base64 = "MIIDljCCAn6gAwIBAgIOSETcxtRwD...S+kAFXIwugUGYEnTWp0m5bAn5NlD314IEOg4mnS8Q==";\n\nconst cert = new x509.X509Certificate(base64);\nconsole.log(cert.subject); // CN=Test, O=PeculiarVentures LLC\n'})}),"\n",(0,r.jsx)(n.h3,{id:"create-a-pkcs10-certificate-request",children:"Create a PKCS#10 certificate request"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'const alg = {\n  name: "ECDSA",\n  namedCurve: "P-384",\n  hash: "SHA-384",\n}\nconst keys = await crypto.subtle.generateKey(alg, false, ["sign", "verify"]);\nconst csr = await x509.Pkcs10CertificateRequestGenerator.create({\n  name: "CN=Test",\n  keys,\n  signingAlgorithm: alg,\n  extensions: [\n    new x509.KeyUsagesExtension(x509.KeyUsageFlags.digitalSignature | x509.KeyUsageFlags.keyEncipherment),\n  ],\n  attributes: [\n    new x509.ChallengePasswordAttribute("password"),\n  ]\n});\n\nconsole.log(csr.toString("base64")); // Certificate request in Base64 format\n'})}),"\n",(0,r.jsx)(n.h3,{id:"decoded-x509-certificate",children:"Decoded X509 certificate"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"X509Certificate {\n  rawData: ArrayBuffer {\n    [Uint8Contents]: <30 82 02 fc 30 82 01 e4 a0 03 02 01 02 02 01 01 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 30 0f 31 0d 30 0b 06 03 55 04 03 13 04 54 65 73 74 30 1e 17 0d 31 39 31 32 33 31 32 31 30 30 30 30 5a 17 0d 32 30 30 31 30 31 32 31 30 30 30 30 5a 30 0f 31 0d 30 0b 06 03 55 04 03 13 04 54 65 73 74 30 82 01 ... 668 more bytes>,\n    byteLength: 768\n  },\n  tbs: ArrayBuffer {\n    [Uint8Contents]: <30 82 01 e4 a0 03 02 01 02 02 01 01 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 30 0f 31 0d 30 0b 06 03 55 04 03 13 04 54 65 73 74 30 1e 17 0d 31 39 31 32 33 31 32 31 30 30 30 30 5a 17 0d 32 30 30 31 30 31 32 31 30 30 30 30 5a 30 0f 31 0d 30 0b 06 03 55 04 03 13 04 54 65 73 74 30 82 01 22 30 0d 06 ... 388 more bytes>,\n    byteLength: 488\n  },\n  serialNumber: '01',\n  subject: 'CN=Test',\n  issuer: 'CN=Test',\n  signatureAlgorithm: { name: 'RSASSA-PKCS1-v1_5', hash: { name: 'SHA-256' } },\n  signature: ArrayBuffer {\n    [Uint8Contents]: <2e 78 fb 4b f6 c8 a1 9d b4 d1 8b 22 80 20 c1 68 46 39 a6 11 d1 a9 7a 13 03 8d 1e 0e 5e 87 b5 33 2a ba 44 1b 96 6d 91 e7 fd c0 ce b7 93 fe e4 df d3 d0 57 7c 9a eb 7e 3e 8b ed c6 07 ad 80 df fd 8f f7 ce 26 07 db 0e 9f af e6 cb 70 02 2d 17 9f f5 c1 0d ef d6 cf 1d ec 78 a0 dd 5d 46 2a 60 08 71 74 2c 26 ... 156 more bytes>,\n    byteLength: 256\n  },\n  notBefore: 2019-12-31T21:00:00.000Z,\n  notAfter: 2020-01-01T21:00:00.000Z,\n  extensions: Extensions(4) [\n    BasicConstraintsExtension {\n      rawData: [ArrayBuffer],\n      type: '2.5.29.19',\n      critical: true,\n      value: [ArrayBuffer],\n      ca: true,\n      pathLength: 2\n    },\n    ExtendedKeyUsageExtension {\n      rawData: [ArrayBuffer],\n      type: '2.5.29.37',\n      critical: true,\n      value: [ArrayBuffer],\n      usages: [ExtendedKeyUsage]\n    },\n    KeyUsagesExtension {\n      rawData: [ArrayBuffer],\n      type: '2.5.29.15',\n      critical: true,\n      value: [ArrayBuffer],\n      usages: 96\n    },\n    SubjectKeyIdentifierExtension {\n      rawData: [ArrayBuffer],\n      type: '2.5.29.14',\n      critical: false,\n      value: [ArrayBuffer],\n      keyId: 'f525754650a3dee83f8bd777ee3b53ecc2c8d726'\n    }\n  ],\n  publicKey: PublicKey {\n    rawData: ArrayBuffer {\n      [Uint8Contents]: <30 82 01 22 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00 03 82 01 0f 00 30 82 01 0a 02 82 01 01 00 b6 f4 f1 cf dd 26 a1 23 45 b6 6e 4e ec 3e 20 8a 3f 90 ec 84 46 49 87 a2 05 c5 eb da ac 84 37 eb a3 bf 46 b5 8e 82 75 25 8a 80 19 10 79 13 c0 13 6c 29 df 56 44 1c ec f8 7b 34 0a f2 13 41 b5 53 98 e1 f5 ... 194 more bytes>,\n      byteLength: 294\n    },\n    algorithm: {\n      name: 'RSASSA-PKCS1-v1_5',\n      publicExponent: [Uint8Array],\n      modulusLength: 2048\n    }\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"build-a-certificate-chain",children:"Build a certificate chain"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"const chain = new x509.X509ChainBuilder({\n  certificates: [\n    new x509.X509Certificate(raw1),\n    new x509.X509Certificate(raw2),\n    // ...\n    new x509.X509Certificate(rawN),\n  ],\n});\n\nconst cert = x509.X509Certificate(raw);\nconst items = await chain.build(cert);\nconsole.log(items); // [ X509Certificate, X509Certificate, X509Certificate ]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"export-a-list-of-x509-certificates-to-pkcs7-format",children:"Export a list of X509 certificates to PKCS#7 format"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'const certs = new x509.X509Certificates([\n  new x509.X509Certificate("MIIDljCCAn6gAwIBAgIOSETcxtRwD...S+kAFXIwugUGYEnTWp0m5bAn5NlD314IEOg4mnS8Q=="),\n  new x509.X509Certificate("MIIDljCCAn6gAwIBAgIOSETcxtRwD...w8Y/o+hk3QzNBVa3ZUvzDhVAmamQflvw3lXMm/JG4U="),\n]);\n\nconsole.log(certs.export("base64")); // "MIICTAYJKoZIhvcNAQcCoIICPTCCAjkCAQAxADACBgCgggIq...F7EZPNo3pjbfznpIilRMRrmwf5dkgCdSKDdE94xAA==");\n'})})]})}function f(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>c});var r=t(6540);const a={},s=r.createContext(a);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);